{"mappings":"AAkCA;;;;AAGA;;;;AAGA;;;;AAKA;;;;;AAIA;;;;;AAMA;;;;;AAIA;;;;;AAMA;;;;;AAIA;;;;;AAMA;;;;;AAIA;;;;;AAMA;;;;;AAIA;;;;;AC1DA;;;;A;;;;AASE;;;;AAKF;;;;;AAIE;;;;;AAMF;;;;;AAIE;;;;;AAMF;;;;;AAIE;;;;;AAMF;;;;;AAIE;;;;;AAMF;;;;;AAIE;;;;;AC1DF;;;;A;;;;AASE;;;;AAKF;;;;;AAIE;;;;;AAMF;;;;;AAIE;;;;;AAMF;;;;;AAIE;;;;;AAMF;;;;;AAIE;;;;;AAMF;;;;;AAIE;;;;;ACsDF;;;;AAGA;;;;AAGA;;;;AClHA;;;;AAGA;;;;ACwFA;;;;AAGC;;;;;;;;;;AAMA;;;;AAGD;;;;;;;;A","sources":["src/components/dropDown.vue","src/components/columntoolbarDropdown.vue","src/components/rowtoolbarDropdown.vue","src/components/tableEditor.vue","src/pages/CreateFromSpreadsheet.vue","src/pages/Edit.vue"],"sourcesContent":["<template>\n    <div class=\"dropdown-wrapper relative\">\n    <button v-on:click=\"show = !show\" :class=\"'bg-'+color+'-500'\" class=\"rounded-lg text-white font-bold py-2 px-4 whitespace-no-wrap rounded transition duration-300\">Choose a style <svg\n  width=\"24\"\n  height=\"24\"\n  viewBox=\"0 0 24 24\"\n  fill=\"none\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n>\n  <path\n    d=\"M11.0001 3.67157L13.0001 3.67157L13.0001 16.4999L16.2426 13.2574L17.6568 14.6716L12 20.3284L6.34314 14.6716L7.75735 13.2574L11.0001 16.5001L11.0001 3.67157Z\"\n    fill=\"currentColor\"\n  />\n</svg></button>\n    <transition :name=\"animation\">\n      <div :class=\"'bg-'+color+'-500'\" class=\"dropdown-menu text-white mt-1 rounded-lg absolute z-10 shadow-lg w-40 max-w-xs\" v-if=\"show\">\n        <ul class=\"list-none overflow-hidden rounded-lg\">\n          <li class=\"mb-0\" v-for=\"(style, index) in styles\" :key=\"index\">\n            <a href=\"javascript:void(0)\" @click=\"handleStyleSwitch(style)\" class=\"flex py-2 px-4 transition duration-300\" :class=\"'hover:bg-'+color+'-800'+ ' ' + 'theme-'+color\">{{style}}</a>\n          </li>\n        </ul>\n      </div>\n    </transition>\n  </div>\n</template>\n<style scoped>\n/* button{\n  cursor:pointer;\n  &:focus{\n    outline:none;\n  }\n} */\n\n/* Animations */\n.fade-enter-active, .fade-leave-active {\n  transition: opacity .5s;\n}\n.dropdown-wrapper svg {\n    display: inline;\n}\n.fade-enter, .fade-leave-to {\n  opacity: 0;\n}\n\n/* Slide-in-up animation*/\n.slide-in-up-enter-active, .slide-in-up-leave-active {\n  transition: all .5s;\n  transform: translateY(0);\n}\n.slide-in-up-enter, .slide-in-up-leave-to {\n  opacity: 0;\n  transform: translateY(20px);\n}\n\n/* Slide-in-right animation*/\n.slide-in-right-enter-active, .slide-in-right-leave-active {\n  transition: all .5s;\n  transform: translateX(0);\n}\n.slide-in-right-enter, .slide-in-right-leave-to {\n  opacity: 0;\n  transform: translateX(20px);\n}\n\n/* Slide-in-left animation*/\n.slide-in-left-enter-active, .slide-in-left-leave-active {\n  transition: all .5s;\n  transform: translateX(0);\n}\n.slide-in-left-enter, .slide-in-left-leave-to {\n  opacity: 0;\n  transform: translateX(-20px);\n}\n\n/* Scale animation*/\n.scale-enter-active, .scale-leave-active {\n  transition: all .5s;\n  transform: scale(1);\n}\n.scale-enter, .scale-leave-to {\n  opacity: 0;\n  transform: scale(0);\n}\n\n/* Rotate animation*/\n.rotate-enter-active, .rotate-leave-active {\n  transition: all .5s;\n  transform: scale(1) rotate(-360deg);\n}\n.rotate-enter, .rotate-leave-to {\n  opacity: 0;\n  transform: scale(0) rotate(360deg);\n}\n</style>\n\n<script>\nexport default {\n    data() {\n    return{\n      show: false,\n    }\n  },\n  methods: {\n    handleStyleSwitch(a) {\n      if (a == \"Style 2\") {\n        let ll = JSON.parse($0.innerText);\n        let xz = Object.keys(ll).filter(e => e !== 'exceltotable-premium-frontend-runtime').map(e => ({[e] : ll[e].src}))[0]\n        xz['exceltotable-style2'];\n        var script = document.createElement('script');\n        script.onload = function () {\n            //do stuff with the script\n            debugger;\n        };\n        script.src = xz['exceltotable-style2'];\n\n        document.head.appendChild(script);\n      }\n    }\n  },\n  props: {\n    color: String,\n    animation: String,\n    styles: Array,\n  },\n}\n</script>","<template>\n    <span class=\"toolbar-tool\">\n    <button v-on:click=\"show = !show\" @mouseenter=\"columnBtnHover = true\" @mouseleave=\"columnBtnHover = false\" class=\"bg-gray-100 py-2 px-4 hover:bg-gray-800 hover:text-white\" v-bind:class=\"[\n              show && 'bg-gray-800 text-white'\n            ]\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" enable-background=\"new 0 0 24 24\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" v-bind:fill=\"[show || columnBtnHover ? '#ffffff' : '#000000']\"><rect fill=\"none\" height=\"24\" width=\"24\"/><path d=\"M3,5v14h18V5H3z M8.33,17H5V7h3.33V17z M13.67,17h-3.33V7h3.33V17z M19,17h-3.33V7H19V17z\"/></svg>\n        <span>Column</span>\n    </button>\n    <transition :name=\"animation\">\n      <div class=\"dropdown-menu text-white bg-gray-100 absolute z-10 shadow-lg max-w-xs\" @mouseleave=\"show = false\" v-if=\"show\">\n        <div class=\"list-none overflow-hidden rounded-lg\">\n          <button @click=\"addColumnRight\" class=\"bg-white py-2 px-4 hover:bg-gray-800\">\n            <img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAABC0lEQVRIid2VPQoCMRCFP7UXtBD0EGIniB5g/cETaSOCp7Gz9OcEtmKrrTYqWq7FJhLGzW52V0F8MEVeZuZNMhMC/4oucAR8ix0Bz/BvAKUkAlHJtR0M/zuwA6quAnHJtUn/PVD7pECYbc1EedcjJYAf7/JDV6Tx9SbXsYxpLkLABbb4F77R5MwCJ2BM8HpTw3bnc6CSJXGUwAIoqP0hsAFuytbAIIvAGSiqvZmlAB+YphWYGJWbfAtoC66fRqCp+I3gw/xXaQTKir8alUvok1xM0nVMH2IdFhf76EzID0fP/Jr4K1q6CHgEP5YOGil+IJK1gY7geklOEoYp7z2S05YZfYJpuSpbYqn8CVxttbGJIJXVAAAAAElFTkSuQmCC\"/>\n          </button>\n          <button @click=\"addColumnLeft\" class=\"bg-white py-2 px-4 hover:bg-gray-800\">\n            <img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAABEUlEQVRIid2VPW4CMRCFP6BHCgWIS6B0SBEcgD/lRKSJVuI06VJu2BvQgOihhQZQKKFYWzITO2vvT8OTpvCz/d54PJbh2fACvBrjMbAHbo7YAyNf8S6wBX4N7j9xHTsf8Q6wMTZpZInL9U6sAsSCDOo+7mWgDaypsERgv+RSDSBt016ZBrUMQ9/snDqVX3IRgwPwwePLD4ar5l+knVcYNvFvoKHm34EEuKhYArMiBkegqeYWjgRuQJTX4NPI3OTfgIHgpnkM+opPBG9b/5PHoKX4s5G5hD7JCcLb9CrGtv1Zj/cB8sPRPb8ku0Sxj8GI9MfSm+aKnwmxATAU3CTkJDZE/L0j2W2FMSXtlrOKGJH5HeqytKMUvYpHAAAAAElFTkSuQmCC\"/>\n          </button>\n        </div>\n      </div>\n    </transition>\n  </span>\n</template>\n<style scoped>\n/* button{\n  cursor:pointer;\n  &:focus{\n    outline:none;\n  }\n} */\n\n/* Animations */\n.fade-enter-active, .fade-leave-active {\n  transition: opacity .5s;\n}\n\n.dropdown-wrapper svg {\n    display: inline;\n}\n\n.toolbar-tool svg, .toolbar-tool svg:hover {\n  display: inline;\n}\n\n.fade-enter, .fade-leave-to {\n  opacity: 0;\n}\n\n/* Slide-in-up animation*/\n.slide-in-up-enter-active, .slide-in-up-leave-active {\n  transition: all .5s;\n  transform: translateY(0);\n}\n.slide-in-up-enter, .slide-in-up-leave-to {\n  opacity: 0;\n  transform: translateY(20px);\n}\n\n/* Slide-in-right animation*/\n.slide-in-right-enter-active, .slide-in-right-leave-active {\n  transition: all .5s;\n  transform: translateX(0);\n}\n.slide-in-right-enter, .slide-in-right-leave-to {\n  opacity: 0;\n  transform: translateX(20px);\n}\n\n/* Slide-in-left animation*/\n.slide-in-left-enter-active, .slide-in-left-leave-active {\n  transition: all .5s;\n  transform: translateX(0);\n}\n.slide-in-left-enter, .slide-in-left-leave-to {\n  opacity: 0;\n  transform: translateX(-20px);\n}\n\n/* Scale animation*/\n.scale-enter-active, .scale-leave-active {\n  transition: all .5s;\n  transform: scale(1);\n}\n.scale-enter, .scale-leave-to {\n  opacity: 0;\n  transform: scale(0);\n}\n\n/* Rotate animation*/\n.rotate-enter-active, .rotate-leave-active {\n  transition: all .5s;\n  transform: scale(1) rotate(-360deg);\n}\n.rotate-enter, .rotate-leave-to {\n  opacity: 0;\n  transform: scale(0) rotate(360deg);\n}\n</style>\n\n<script>\nexport default {\n    data() {\n    return{\n      show: false,\n      columnBtnHover: false,\n      hover: false,\n    }\n  },\n  methods: {\n    handleStyleSwitch(a) {\n      if (a == \"Style 2\") {\n        let ll = JSON.parse($0.innerText);\n        let xz = Object.keys(ll).filter(e => e !== 'exceltotable-premium-frontend-runtime').map(e => ({[e] : ll[e].src}))[0]\n        xz['exceltotable-style2'];\n        var script = document.createElement('script');\n        script.onload = function () {\n            //do stuff with the script\n            debugger;\n        };\n        script.src = xz['exceltotable-style2'];\n\n        document.head.appendChild(script);\n      }\n    },\n    addColumnLeft(a) {\n      let {activeCell} = this.$parent.$refs.grid;\n      if (typeof(activeCell.columnIndex) == 'undefined') return;\n      let newCells = this.$store.state.grid.data.map((ee) => [\n                ...ee.slice(0, activeCell.columnIndex),\n                \"\",\n                ...ee.slice(activeCell.columnIndex),\n              ]);\n              this.$store.commit(\"updateGrid\", newCells);\n              this.$parent.$refs.grid.setActiveCell(activeCell.columnIndex +1 ,activeCell.rowIndex);\n              this.$parent.$refs.grid.refresh();\n              this.$parent.$refs.grid.selectNone();\n              // this.$parent.$refs.grid.activeCell = activeCell;\n    },\n    addColumnRight(a) {\n      let {activeCell} = this.$parent.$refs.grid;\n      if (typeof(activeCell.columnIndex) == 'undefined') return;\n      let newCells = this.$store.state.grid.data.map((ee) => [\n                ...ee.slice(0, activeCell.columnIndex + 1),\n                \"\",\n                ...ee.slice(activeCell.columnIndex + 1),\n              ]);\n              this.$store.commit(\"updateGrid\", newCells);\n              \n              this.$parent.$refs.grid.setActiveCell(activeCell.columnIndex ,activeCell.rowIndex);\n              this.$parent.$refs.grid.refresh();\n              this.$parent.$refs.grid.selectNone();\n    }\n  },\n  props: {\n    color: String,\n    animation: String,\n    styles: Array,\n  },\n}\n</script>","<template>\n    <span class=\"toolbar-tool\">\n    <button v-on:click=\"show = !show\" class=\"bg-gray-100 py-2 px-4 hover:bg-gray-800 hover:text-white\" v-bind:class=\"[\n              show && 'bg-gray-800 text-white'\n            ]\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" enable-background=\"new 0 0 24 24\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"#000000\"><rect fill=\"none\" height=\"24\" width=\"24\"/><path d=\"M19,3H5C3.9,3,3,3.9,3,5v14c0,1.1,0.9,2,2,2h14c1.1,0,2-0.9,2-2V5C21,3.9,20.1,3,19,3z M19,5v3H5V5H19z M19,10v4H5v-4H19z M5,19v-3h14v3H5z\"/></svg>\n        <span>Rows</span>\n    </button>\n    <transition :name=\"animation\">\n      <div class=\"dropdown-menu text-white bg-gray-100 absolute z-10 shadow-lg max-w-xs\" v-if=\"show\">\n        <div class=\"list-none overflow-hidden rounded-lg\">\n          <button @click=\"addRow\" class=\"bg-white py-2 px-4 hover:bg-gray-800\">\n            <img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAABA0lEQVRIie3TMUoDURAG4C9qLdiInsBSbSUeIJrghewk4Ak8hpWWMbmAtinsTClYGIllLPIWHi9vs4bdLvlhYPnf/PPPDLNssVG4wgTzmjFBJ2fQRPEiPoqirchgXmP6HFqw03DRJezV1H/hAU94xy9O0Mslr7vnZ+yv0806xR+xG3Q3GOEnxLDuBJ84DJr7FXn91OC/Z3obdR7zF2gnXDc26Fjcb5XBWcgfJXxuEy+5VcVJqzCNOk9RTPLdxH+Qq9HKcM4xs7ySGU4z+UPVKxrEggOMMwbj8Jail+S1cZlw16noODEZB64M/UxDRdyViY7whtfwXYWuxbVMQwxynW9Rij+5ga2gTkQyZAAAAABJRU5ErkJggg==\"/>\n          </button>\n          <button @click=\"addRowAbove\" class=\"bg-white py-2 px-4 hover:bg-gray-800\">\n            <img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAABEElEQVRIid3TMUoDQRgF4C9qLdho8AKWppZ4gGiCF7ITwRN4DCstY3ICKyGInSkFCyOx1CKzsA4Ts5tZLHzwmn/+ee/Nv//yH9HGQ2C7afE9POIr8An7TYnvYFISLzgJZ9noYJ4wmOOwCYMyCvFsbDQhUtXgBFM/k8fjqsIpeimz6Rpiy/hSiLaitE2ixR98g63M+2+4xi2e8YkDDFLNded8h+06aeqI32Az3DvDGB+Bo9wXvGI33Ln6pe8yNqi6puel5OX6EbpRrV826Fns7yqDTugfR/XUJO5To6qKWSl5jOIl7038BymNVqJWGyOrRzTMMRhEYl0cR7XTHAMWq7hsGS5yxQv0LbZlFjhUSv4Nt4WrpM/C+VsAAAAASUVORK5CYII=\"/>\n          </button>\n        </div>\n      </div>\n    </transition>\n  </span>\n</template>\n<style scoped>\n/* button{\n  cursor:pointer;\n  &:focus{\n    outline:none;\n  }\n} */\n\n/* Animations */\n.fade-enter-active, .fade-leave-active {\n  transition: opacity .5s;\n}\n\n.dropdown-wrapper svg {\n    display: inline;\n}\n\n.toolbar-tool svg, .toolbar-tool svg:hover {\n  display: inline;\n}\n\n.fade-enter, .fade-leave-to {\n  opacity: 0;\n}\n\n/* Slide-in-up animation*/\n.slide-in-up-enter-active, .slide-in-up-leave-active {\n  transition: all .5s;\n  transform: translateY(0);\n}\n.slide-in-up-enter, .slide-in-up-leave-to {\n  opacity: 0;\n  transform: translateY(20px);\n}\n\n/* Slide-in-right animation*/\n.slide-in-right-enter-active, .slide-in-right-leave-active {\n  transition: all .5s;\n  transform: translateX(0);\n}\n.slide-in-right-enter, .slide-in-right-leave-to {\n  opacity: 0;\n  transform: translateX(20px);\n}\n\n/* Slide-in-left animation*/\n.slide-in-left-enter-active, .slide-in-left-leave-active {\n  transition: all .5s;\n  transform: translateX(0);\n}\n.slide-in-left-enter, .slide-in-left-leave-to {\n  opacity: 0;\n  transform: translateX(-20px);\n}\n\n/* Scale animation*/\n.scale-enter-active, .scale-leave-active {\n  transition: all .5s;\n  transform: scale(1);\n}\n.scale-enter, .scale-leave-to {\n  opacity: 0;\n  transform: scale(0);\n}\n\n/* Rotate animation*/\n.rotate-enter-active, .rotate-leave-active {\n  transition: all .5s;\n  transform: scale(1) rotate(-360deg);\n}\n.rotate-enter, .rotate-leave-to {\n  opacity: 0;\n  transform: scale(0) rotate(360deg);\n}\n</style>\n\n<script>\nexport default {\n    data() {\n    return{\n      show: false,\n    }\n  },\n  methods: {\n    handleStyleSwitch(a) {\n      if (a == \"Style 2\") {\n        let ll = JSON.parse($0.innerText);\n        let xz = Object.keys(ll).filter(e => e !== 'exceltotable-premium-frontend-runtime').map(e => ({[e] : ll[e].src}))[0]\n        xz['exceltotable-style2'];\n        var script = document.createElement('script');\n        script.onload = function () {\n            //do stuff with the script\n            debugger;\n        };\n        script.src = xz['exceltotable-style2'];\n\n        document.head.appendChild(script);\n      }\n    },\n    addColumnLeft(a) {\n      let {activeCell} = this.$parent.$refs.grid;\n      if (typeof(activeCell.columnIndex) == 'undefined') return;\n      let newCells = this.$store.state.grid.data.map((ee) => [\n                ...ee.slice(0, activeCell.columnIndex),\n                \"\",\n                ...ee.slice(activeCell.columnIndex),\n              ]);\n              this.$store.commit(\"updateGrid\", newCells);\n              this.$parent.$refs.grid.setActiveCell(activeCell.columnIndex +1 ,activeCell.rowIndex);\n              this.$parent.$refs.grid.refresh();\n              this.$parent.$refs.grid.selectNone();\n              // this.$parent.$refs.grid.activeCell = activeCell;\n    },\n    addColumnRight(a) {\n      let {activeCell} = this.$parent.$refs.grid;\n      if (typeof(activeCell.columnIndex) == 'undefined') return;\n      let newCells = this.$store.state.grid.data.map((ee) => [\n                ...ee.slice(0, activeCell.columnIndex + 1),\n                \"\",\n                ...ee.slice(activeCell.columnIndex + 1),\n              ]);\n              this.$store.commit(\"updateGrid\", newCells);\n              \n              this.$parent.$refs.grid.setActiveCell(activeCell.columnIndex ,activeCell.rowIndex);\n              this.$parent.$refs.grid.refresh();\n              this.$parent.$refs.grid.selectNone();\n    },\n    addRow() {\n      debugger\n    },\n    addRowAbove() {\n      debugger\n    }\n  },\n  props: {\n    color: String,\n    animation: String,\n    styles: Array,\n  },\n}\n</script>","<template>\n  <div>\n    <div\n      class=\"\n        mb-4 bg-white rounded-lg p-6\n        flex flex-col\n        space-y-4\n        lg:space-y-0\n        lg:flex-row\n        lg:items-center\n        lg:justify-between\n      \"\n    >\n      <ul class=\"flex main-nav border-b tab-buttons\">\n        <li class=\"mr-1\">\n          <button\n            data-tab-index=\"0\"\n            @click=\"handleTabSwitch\"\n            v-bind:class=\"[\n              tabNavigation == 0 ? tabActiveClass : tabInactiveClass,\n            ]\"\n            class=\"tab-item bg-white inline-block py-2 px-4 font-semibold\"\n          >\n            Table Editor\n          </button>\n        </li>\n        <li class=\"mr-1\">\n          <button\n            data-tab-index=\"1\"\n            @click=\"handleTabSwitch\"\n            v-bind:class=\"[\n              tabNavigation == 1 ? tabActiveClass : tabInactiveClass,\n            ]\"\n            class=\"tab-item bg-white inline-block py-2 px-4 font-semibold\"\n          >\n            Preview\n          </button>\n        </li>\n        <li class=\"mr-1\">\n          <button\n            data-tab-index=\"2\"\n            @click=\"handleTabSwitch\"\n            v-bind:class=\"[\n              tabNavigation == 2 ? tabActiveClass : tabInactiveClass,\n            ]\"\n            class=\"tab-item bg-white inline-block py-2 px-4 font-semibold\"\n          >\n            Embed\n          </button>\n        </li>\n      </ul>\n      <div class=\"flex items-center justify-center space-x-4\">\n      <button\n            class=\"rounded-lg text-white font-bold py-2 px-4 whitespace-no-wrap rounded transition duration-300 bg-blue-500\"\n            @click=\"showSettings\"\n            type=\"button\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"#FFFFFF\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M19.43 12.98c.04-.32.07-.64.07-.98 0-.34-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.09-.16-.26-.25-.44-.25-.06 0-.12.01-.17.03l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.06-.02-.12-.03-.18-.03-.17 0-.34.09-.43.25l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98 0 .33.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.09.16.26.25.44.25.06 0 .12-.01.17-.03l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.06.02.12.03.18.03.17 0 .34-.09.43-.25l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zm-1.98-1.71c.04.31.05.52.05.73 0 .21-.02.43-.05.73l-.14 1.13.89.7 1.08.84-.7 1.21-1.27-.51-1.04-.42-.9.68c-.43.32-.84.56-1.25.73l-1.06.43-.16 1.13-.2 1.35h-1.4l-.19-1.35-.16-1.13-1.06-.43c-.43-.18-.83-.41-1.23-.71l-.91-.7-1.06.43-1.27.51-.7-1.21 1.08-.84.89-.7-.14-1.13c-.03-.31-.05-.54-.05-.74s.02-.43.05-.73l.14-1.13-.89-.7-1.08-.84.7-1.21 1.27.51 1.04.42.9-.68c.43-.32.84-.56 1.25-.73l1.06-.43.16-1.13.2-1.35h1.39l.19 1.35.16 1.13 1.06.43c.43.18.83.41 1.23.71l.91.7 1.06-.43 1.27-.51.7 1.21-1.07.85-.89.7.14 1.13zM12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z\"/></svg>\n          </button>\n\t\t  <drop-down animation=\"fade\" color=\"blue\" :styles=\"styles\"></drop-down>\n      </div>\n    </div>\n    <div v-if=\"tabNavigation == 0\" class=\"\n        mb-4 bg-white rounded-lg p-6\n        flex flex-col\n        space-y-4\n        lg:space-y-0\n        lg:flex-row\n        lg:items-center\n        lg:justify-between\n      \">\n      <div class=\"px-5 py-3 w-full h-full\">\n        <div class=\"mb-2 toolbar flex\" style=\"width: fit-content\">\n          <columntoolbar-dropdown animation=\"fade\" color=\"blue\" :styles=\"styles\"></columntoolbar-dropdown>\n          <rowtoolbar-dropdown animation=\"fade\" color=\"blue\" :styles=\"styles\"></rowtoolbar-dropdown>\n        </div>\n        <canvas-datagrid\n          v-if=\"grid.data.length\"\n          allowSorting=\"false\"\n          v-bind:style=\"{ width: canvasWidth, height: canvasHeight }\"\n          @contextmenu=\"handleRightClick\"\n          @sortcolumn=\"handleGridEvent\"\n          @afterrendercell=\"handleRender\"\n          ref=\"grid\"\n          :data.prop=\"grid.data\"\n          allow-sorting=\"0\"\n          columnHeaderClickBehavior=\"0\"\n        ></canvas-datagrid>\n      </div>\n    </div>\n    <div\n      class=\"pb-5\" :style=\"{display: tabNavigation == 1 ? 'block': 'none'}\">\n      <!-- <table-element v-if=\"grid.data.length\" :cellItems=\"grid.data\" :tableTitle=\"tableTitle\" :showSearchBar=\"showSearchBar\"></table-element> -->\n\n      <div :style=\"{display: tabNavigation == 1 ? 'block': 'none'}\" class=\"table-container\">\n        <div :style=\"{display: tabNavigation == 1 ? 'block': 'none'}\" class=\"excel-to-table-app\">\n          <iframe style=\"width: 100%; height: 50rem;\" src=\"http://myplugindev.test/?wut_action=load_preview\"></iframe>\n        </div>\n      </div>\n    </div>\n    <div v-if=\"tabNavigation == 2\">\n      <div\n        class=\"mb-4 bg-white rounded-lg p-6\n          flex flex-col\n          space-y-4\n          lg:space-y-0\n          lg:flex-row\n          lg:items-center\n          lg:justify-between\n        \"\n      >\n        <div>\n          <p class=\"text-xl font-bold mt-3 mb-5\">\n            Insert the table to any of your posts or pages\n          </p>\n        </div>\n        <div class=\"text-xl mb-2\">\n          <span>[wp-table id=\"{{ editingTableId }}\"]</span>\n          <span @click=\"handleShortcodeCopy\" class=\"copy-icon\">\n            <svg\n              width=\"24\"\n              height=\"24\"\n              viewBox=\"0 0 24 24\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            >\n              <path d=\"M13 7H7V5H13V7Z\" fill=\"currentColor\" />\n              <path d=\"M13 11H7V9H13V11Z\" fill=\"currentColor\" />\n              <path d=\"M7 15H13V13H7V15Z\" fill=\"currentColor\" />\n              <path\n                fill-rule=\"evenodd\"\n                clip-rule=\"evenodd\"\n                d=\"M3 19V1H17V5H21V23H7V19H3ZM15 17V3H5V17H15ZM17 7V19H9V21H19V7H17Z\"\n                fill=\"currentColor\"\n              />\n            </svg>\n          </span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.copy-icon svg {\n  display: inline;\n}\n.copy-icon {\n  cursor: pointer;\n}\n.toolbar button svg {\n  display: inline;\n}\n</style>\n<script>\n// import indexedDBHelper from \"../../admin/utils/indexedDBHelper\";\nimport dropDown from '../components/dropDown.vue';\nimport columntoolbarDropdown from '../components/columntoolbarDropdown.vue';\nimport rowtoolbarDropdown from '../components/rowtoolbarDropdown.vue'\nexport default {\n  data() {\n    return {\n      tabNavigation: 0,\n      tabActiveClass:\n        \"rounded-lg bg-blue-500 inline-block py-2 px-4 font-semibold text-white\",\n      tabInactiveClass: \"text-blue-500 hover:text-blue-800\",\n      styles: [\n        \"Style 1 (Active)\",\n        \"Style 2 (Premium)\"\n      ],\n      currentStyle: 'Style 1'\n    };\n  },\n  computed: {\n    canvasHeight() {\n      return window.innerHeight - 500 + \"px\";\n    },\n    canvasWidth() {\n      return window.innerWidth - 300 + \"px\";\n    },\n    grid: {\n      get: function () {\n        return this.$store.state.grid;\n      },\n      // setter\n      set: function (newGrid) {\n        return this.$store.commit(\"updateGrid\", newGrid.data);\n      },\n    },\n    tableTitle: {\n      get: function () {\n        return this.$store.state.tableTitle;\n      },\n    },\n    showSearchBar: {\n      get: function () {\n        return this.$store.state.grid.showSearchBar || true;\n      },\n    },\n    editingTableId: function () {\n      return this.$store.state.editingTableId;\n    },\n  },\n  methods: {\n    getStateDump() {\n      return JSON.stringify(this.$store.state);\n    },\n    async handleTabSwitch(event) {\n      debugger;\n      let selectedTabIndex = parseInt(\n        event.target.getAttribute(\"data-tab-index\")\n      );\n      if (selectedTabIndex == 0) {\n        this.setGridStyle();\n      }\n      if (typeof this.$refs.grid !== \"undefined\") {\n        try {\n          this.$refs.grid.endEdit();\n        } catch (error) {\n          // no need to handle\n        }\n      }\n      this.tabNavigation = selectedTabIndex;\n      if (selectedTabIndex == 1) {\n        let iframedPreview = this.$el.querySelector('iframe');\n        let stateSnapshot = {...this.$store.state.grid, tableTitle: this.$store.state.tableTitle};\n        iframedPreview.contentWindow.manipulateStore(JSON.parse(JSON.stringify(stateSnapshot)));\n      }\n      if (selectedTabIndex !== 1) {\n        // jQuery(\".table-container\").parent().hide();\n      }\n    },\n    showSettings() {\n      return this.$store.commit(\"setSettingsModalStatus\", true);\n    },\n    handleShortcodeCopy() {\n      window.navigator.clipboard.writeText(\n        `[wp-table id=\\\"${this.editingTableId}\\\"]`\n      );\n    },\n    handleRender(e) {\n      // if (e.cell.columnIndex === 1 && e.cell.rowIndex > -1 && e.cell.value) {\n      //   e.cell.innerHTML =\n      //     '<a style=\"display: inline-block; color: dodgerblue;\" href=\"https://bing.com\">' +\n      //     e.cell.value +\n      //     \"</a>\";\n      // }\n    },\n    handleGridEvent(e, v, i, c) {\n      this.$refs.grid.setActiveCell(null);\n    },\n    setGridStyle() {\n      [1, 10, 50, 100, 200, 400, 700, 1000].forEach((n) => {\n        setTimeout(() => {\n          if (!this.$refs.hasOwnProperty('grid')) return;\n          this.$refs.grid.style.height = \"100%\";\n          this.$refs.grid.style.width = \"100%\";\n          this.$refs.grid.style.gridBackgroundColor = \"white\";\n          this.$refs.grid.style.scrollBarBackgroundColor = \"white\";\n          this.$refs.grid.style.scrollBarBorderColor = \"white\";\n          // this.$refs.grid.style.moveOverlayBorderColor = \"blue\";\n          this.$refs.grid.style.cellHeight = 35;\n        }, n);\n      });\n    },\n    handleRightClick(e, i, v, c) {\n      // e.items.map((e,i) => e.title == 'Add/Remove columns' ? i : '').filter(ee => ee).forEach(eee => delete e.items[eee])\n      let { $store: store } = this;\n      for (let index = 0; index < e.items.length; index++) {\n        // const element = array[index];\n        delete e.items[index];\n      }\n      if (typeof(e.cell.boundColumnIndex) == \"number\" && typeof(e.cell.boundRowIndex) == \"number\") {\n        e.items.push(\n          {\n            title: \"Delete this row\",\n            click: function (w, q) {\n              this.deleteRow(e.cell.boundRowIndex);\n              console.log(e.cell.value, e.cell.data);\n            },\n          },\n          {\n            title: \"Add row\",\n            click: function () {\n              this.insertRow([], e.cell.boundRowIndex);\n            },\n          },\n          {\n            title: \"Duplicate row\",\n            click: function () {\n              this.insertRow(e.cell.data, e.cell.boundRowIndex);\n            },\n          },\n          {\n            title: \"Add column\",\n            click: () => {\n              let newCells = store.state.grid.data.map((ee) => [\n                ...ee.slice(0, e.cell.boundColumnIndex),\n                \"\",\n                ...ee.slice(e.cell.boundColumnIndex),\n              ]);\n              store.commit(\"updateGrid\", newCells);\n            },\n          }\n        );\n      }\n      if (typeof(e.cell.boundColumnIndex) == \"number\" && typeof(e.cell.boundRowIndex) == \"undefined\" && e.cell.boundColumnIndex >= 0) {\n        e.items.push(\n          {\n            title: \"Delete this row\",\n            click: function (w, q) {\n              this.deleteRow(e.cell.boundRowIndex);\n              console.log(e.cell.value, e.cell.data);\n            },\n          }\n        )\n      }\n    },\n  },\n  components: {\n    dropDown,\n    columntoolbarDropdown,\n    rowtoolbarDropdown\n  },\n  mounted() {\n    this.setGridStyle();\n  },\n};\n</script>","<template>\n<div @drop=\"_drop\" @dragenter=\"_suppress\" @dragover=\"_suppress\">\n\t<div v-if=\"fileUploadDone\" class=\"mb-4 bg-white rounded-lg p-6\">\n      <label class=\"block uppercase tracking-wide text-xs font-bold\"\n        >Name</label\n      >\n      <div class=\"flex\">\n        <input\n          v-model=\"tableTitle\"\n          type=\"text\"\n          class=\"block w-full focus:outline-0 bg-white py-3 px-6 mr-2 mb-2 sm:mb-0\"\n          name=\"name\"\n          placeholder=\"Enter the Table Name\"\n          required=\"\"\n        />\n        <div v-if=\"!isSaving\" style=\"display: contents\">\n        <button v-if=\"!['/settings', '/edit', '/'].some(e => e == $route.path)\" @click=\"handleSave\" class=\"rounded-lg bg-blue-500 hover:bg-blue-800 text-white py-2 px-4\">Save</button>\n        <button v-if=\"($route.path == '/edit') && $route.query.table_id\" @click=\"handleUpdate\" class=\"rounded-lg bg-blue-500 hover:bg-blue-800 font-bold text-white py-2 px-4\">Update</button>\n        </div>\n        <div v-if=\"isSaving\">\n        <button class=\"rounded-lg bg-blue-500 hover:bg-blue-800 text-white py-2 px-4\"><i class=\"gg-spinner-alt\"></i></button>\n        </div>\n      </div>\n    </div>\n\t\t<form v-if=\"!fileUploadDone\">\n\t\t\t<div class=\"mb-4 bg-white rounded-lg p-6\">\n\t\t\t\t<label class=\"block uppercase tracking-wide text-xs font-bold\">Upload a Spreadsheet</label>\n\t\t\t\t<input type=\"file\" class=\"w-full shadow-inner p-4 border-0\" id=\"file\" :accept=\"SheetJSFT\" @change=\"_change\" />\n\t\t\t</div>\n\t\t</form>\n\t\t<table-editor v-if=\"$store.state.grid.data.length\" />\n\t\t<settings-modal v-if=\"showSettings\" />\n</div>\n</template>\n<style>\n.main-nav li {\n\tmargin-bottom: 0;\n}\ncanvas-datagrid {\n\toverflow: scroll;\n}\n</style>\n<script>\nimport XLSX from 'xlsx';\nimport CanvasDatagrid from 'canvas-datagrid';\n// import tablesaw from 'tablesaw';\nimport tableEditor from '../components/tableEditor.vue';\nimport settingsModal from \"../components/settings-modal.vue\";\nconst make_cols = refstr => Array(XLSX.utils.decode_range(refstr).e.c + 1).fill(0).map((x,i) => ({name:XLSX.utils.encode_col(i), key:i}));\nconst _SheetJSFT = [\n\t\"xlsx\", \"xlsb\", \"xlsm\", \"xls\", \"xml\", \"csv\", \"txt\", \"ods\", \"fods\", \"uos\", \"sylk\", \"dif\", \"dbf\", \"prn\", \"qpw\", \"123\", \"wb*\", \"wq*\", \"html\", \"htm\"\n].map(function(x) { return \".\" + x; }).join(\",\");\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tSheetJSFT: _SheetJSFT,\n\t\t\tisSaving: false,\n\t\t\tfileUploadDone: false,\n\t\t}; \n\t},\n\tmethods: {\n\t\t_suppress(evt) { evt.stopPropagation(); evt.preventDefault(); },\n\t\t_drop(evt) {\n\t\t\tevt.stopPropagation(); evt.preventDefault();\n\t\t\tconst files = evt.dataTransfer.files;\n\t\t\tif(files && files[0]) this._file(files[0]);\n\t\t},\n\t\t_change(evt) {\n\t\t\tconst files = evt.target.files;\n\t\t\tif(files && files[0]) this._file(files[0]);\n\t\t},\n\t\t_export(evt) {\n\t\t\t/* convert state to workbook */\n\t\t\tconst ws = XLSX.utils.aoa_to_sheet(this.data);\n\t\t\tconst wb = XLSX.utils.book_new();\n\t\t\tXLSX.utils.book_append_sheet(wb, ws, \"SheetJS\");\n\t\t\t/* generate file and send to client */\n\t\t\tXLSX.writeFile(wb, \"sheetjs.xlsx\");\n\t\t},\n\t\tto_json(workbook) {\n\t\t\tif(workbook.SSF) XLSX.SSF.load_table(workbook.SSF);\n\t\t\tvar result = {};\n\t\t\tworkbook.SheetNames.forEach(function(sheetName) {\n\t\t\tvar roa = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName], {raw:false, header:1});\n\t\t\tif(roa.length > 0) result[sheetName] = roa;\n\t\t\t});\n\t\t\treturn result;\n  \t\t},\n\t\t_file(file) {\n\t\t\t/* Boilerplate to set up FileReader */\n\t\t\tconst reader = new FileReader();\n\t\t\treader.onload = (e) => {\n\t\t\t\t/* Parse data */\n\t\t\t\tconst bstr = e.target.result;\n\t\t\t\tconst wb = XLSX.read(bstr, {type:'binary'});\n\t\t\t\t/* Get first worksheet */\n\t\t\t\tconst wsname = wb.SheetNames[0];\n\n\t\t\t\tvar json = this.to_json(wb)[wsname];\n\t\t\t\tconst ws = wb.Sheets[wsname];\n\t\t\t\t/* Convert array of arrays */\n\t\t\t\tconst data = XLSX.utils.sheet_to_json(ws, {raw:true, cellDates:false});\n\t\t\t\t/* Update state */\n\t\t\t\t// this.grid = {data: json};\n\t\t\t\tthis.$store.commit(\"updateGrid\", json);\n\t\t\t\tthis.cols = make_cols(ws['!ref']);\n\t\t\t};\n\t\t\treader.readAsBinaryString(file);\n\t\t\tlet fileNameDotLength = file.name.split('.').length - 1;\n\t\t\tlet possibleTitle = file.name.split('.', fileNameDotLength).join('_');\n\t\t\tthis.$store.commit(\"setTitle\", possibleTitle);\n\t\t\tthis.fileUploadDone = true;\n\t\t},\n\t\thandleSave() {\n\t\t\tlet data =  {\n\t\t\t\ttitle: this.$store.state.tableTitle,\n\t\t\t\tcells: this.$store.state.grid.data,\n\t\t\t\tfontSettings: this.$store.state.fontSettings,\n\t\t\t\tsettingsItemProps: this.$store.state.settingsItemProps\n\t\t\t};\n\t\t\tjQuery.ajax({\n\t\t\t\ttype: 'POST',\n\t\t\t\turl: ajaxurl+ '?action=create_new_table_entry',\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: JSON.stringify(data),\n\t\t\t\tsuccess: (responseData) => {\n\t\t\t\tthis.$router.push({ name: \"Edit Existing\", query: {table_id : responseData.ok} });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tshowSettings: (vm) => {\n\t\t\treturn vm.$store.state.showSettings;\n\t\t},\n\t},\n\tcomputed: {\n\t\ttableTitle: {\n\t\t\tget: function () {\n\t\t\t\treturn this.$store.state.tableTitle;\n\t\t\t},\n\t\t\tset: function (newString) {\n\t\t\t\treturn this.$store.state.tableTitle = newString;\n\t\t\t}\n\t\t},\n\t\tshowSettings: (vm) => {\n\t\t\treturn vm.$store.state.showSettings;\n\t\t},\n\t},\n\tcomponents: {\n\t\ttableEditor,\n\t\tsettingsModal\n  \t},\n\tmounted() {\n\t\t// Tablesaw.init();\n\t\tthis.$store.commit('setPageTitle', \"Editing Table\" );\n\t},\n};\n</script>","<template>\n  <div>\n    <div v-if=\"toEditTable\" class=\"mb-4 bg-white rounded-lg p-6\">\n      <label class=\"block uppercase tracking-wide text-xs font-bold\"\n        >Name</label\n      >\n      <div class=\"flex\">\n        <input\n          v-model=\"tableTitle\"\n          type=\"text\"\n          class=\"block w-full focus:outline-0 bg-white py-3 px-6 mr-2 mb-2 sm:mb-0\"\n          name=\"name\"\n          placeholder=\"Enter the Table Name\"\n          required=\"\"\n        />\n        <div v-if=\"!isSaving\" style=\"display: contents\">\n        <button v-if=\"!['/settings', '/edit', '/'].some(e => e == $route.path)\" @click=\"handleSave\" class=\"rounded-lg bg-blue-500 hover:bg-blue-800 text-white py-2 px-4\">Save</button>\n        <button v-if=\"($route.path == '/edit') && $route.query.table_id\" @click=\"handleUpdate\" class=\"rounded-lg bg-blue-500 hover:bg-blue-800 font-bold text-white py-2 px-4\">Update</button>\n        </div>\n        <div v-if=\"isSaving\">\n        <button class=\"rounded-lg bg-blue-500 hover:bg-blue-800 text-white py-2 px-4\"><i class=\"gg-spinner-alt\"></i></button>\n        </div>\n      </div>\n    </div>\n    <div v-if=\"!avaiableTables.length && !toEditTable && !isEmptyTableList\" class=\"flex justify-center items-center\">\n        <div class=\"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900\"></div>\n    </div>\n    <div v-if=\"isEmptyTableList\" class=\"flex justify-center items-center\" @click=\"goToAppHome\">\n        <div class=\"flex bg-blue-100 rounded-lg p-4 mb-4 text-sm text-blue-700\" role=\"alert\">\n          <svg class=\"w-5 h-5 inline mr-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"><path fill-rule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clip-rule=\"evenodd\"></path></svg>\n          <div>\n              <span class=\"font-medium\">You have no tables available. Click here to create a new table.</span>\n          </div>\n        </div>\n    </div>\n    <table-editor v-if=\"toEditTable\" />\n    <settings-modal v-if=\"showSettings\" />\n    <div\n      v-if=\"!toEditTable\"\n      class=\"\n        container container\n        m-auto\n        flex flex-wrap flex-col\n        md:flex-row\n        items-center\n        justify-start\n      \"\n    >\n      <div\n        v-for=\"(tableName, key) in avaiableTables\"\n        class=\"w-full md:w-1/3 p-3\"\n        :key=\"key\"\n      >\n        <div\n          class=\"\n            flex flex-col\n            lg:flex-row\n            rounded-lg\n            overflow-hidden\n            h-auto\n            lg:h-32\n            border\n            shadow shadow-lg\n          \"\n        >\n          <div\n            class=\"\n              bg-blue-500 bg-opacity-75 transition duration-300\n              rounded-b\n              lg:rounded-b-none lg:rounded-r\n              p-6\n              flex flex-col\n              justify-between\n              leading-normal\n              flex-grow-default\n            \"\n          >\n            <div class=\"text-white font-bold text-xl mb-2 leading-tight\">\n              {{ tableName.post_title }}\n            </div>\n            <ul class=\"flex main-nav border-b tab-buttons\">\n              <li class=\"mr-1\">\n                <button\n                  @click=\"handleEditBtn(tableName.ID)\"\n                  class=\"\n                    tab-item\n                    bg-white\n                    inline-block\n                    py-2\n                    px-4\n                    font-semibold\n                    border-l border-t border-r\n                    rounded-t\n                    text-blue-700\n                    active\n                  \"\n                >\n                  Edit\n                </button>\n              </li>\n              <li class=\"mr-1\">\n                <button\n                  class=\"\n                    tab-item\n                    bg-white\n                    inline-block\n                    py-2\n                    px-4\n                    font-semibold\n                    border-l border-t border-r\n                    rounded-t\n                    text-red-700\n                    active\n                  \"\n                >\n                  Delete\n                </button>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<style scoped>\n.wrap.wptable {\n  background-color: aqua;\n}\n @keyframes spinneralt {\n 0% { transform: rotate(0deg) }\n to { transform: rotate(359deg) }\n}\n\n.gg-spinner-alt {\n transform: scale(var(--ggs,1))\n}\n\n.gg-spinner-alt,\n.gg-spinner-alt::before {\n box-sizing: border-box;\n position: relative;\n display: block;\n width: 20px;\n height: 20px\n}\n\n.gg-spinner-alt::before {\n content: \"\";\n position: absolute;\n border-radius: 100px;\n animation: spinneralt 1s cubic-bezier(.6,0,.4,1) infinite;\n border: 3px solid transparent;\n border-top-color: currentColor\n}\n</style>\n<script>\nimport tableEditor from \"../components/tableEditor.vue\";\nimport settingsModal from \"../components/settings-modal.vue\";\nexport default {\n  name: \"Edit\",\n  data() {\n    return {\n      isEmptyTableList: false,\n      isSaving: false,\n    };\n  },\n  methods: {\n    sampleFunc: () => {},\n    handleSave() {\n      let data =  {\n        title: this.$store.state.tableTitle,\n        cells: this.$store.state.grid.data,\n        fontSettings: this.$store.state.fontSettings,\n        settingsItemProps: this.$store.state.settingsItemProps\n      };\n      jQuery.ajax({\n        type: 'POST',\n        url: ajaxurl+ '?action=create_new_table_entry',\n        dataType: 'json',\n        data: JSON.stringify(data),\n        success: (responseData) => {\n          this.$router.push({ name: \"Edit Existing\", query: {table_id : responseData.ok} });\n        }\n      });\n    },\n    handleUpdate() {\n      let data =  {\n        title: this.$store.state.tableTitle,\n        cells: this.$store.state.grid.data,\n        fontSettings: this.$store.state.fontSettings,\n        tableBodyFontSettings: this.$store.state.tableBodyFontSettings,\n        settingsItemProps: this.$store.state.settingsItemProps,\n        fontUrls: this.$store.state.fontUrls,\n      };\n      let setLoadingStatus = (status) => {\n        this.isSaving = !Boolean(status.success)\n      };\n      jQuery.ajax({\n        type: 'POST',\n        url: ajaxurl+ `?action=sprdsh_update_table_cells&id=${this.$store.state.editingTableId}`,\n        dataType: 'json',\n        data: JSON.stringify(data),\n        beforeSend: setLoadingStatus,\n        success: setLoadingStatus\n      });\n    },\n    goToAppHome() {\n      this.$router.push({name: 'Create A new Table'});\n    },\n    handleEditBtn(tableId) {\n      jQuery.ajax({\n        type: \"GET\",\n        url: ajaxurl + `?action=sprdsh_get_table_cells&id=${tableId}`,\n        vm: this,\n        success(data) {\n          let { vm } = this;\n          vm.$store.commit(\"updateGrid\", data.grid.data);\n          vm.$store.commit(\"setTitle\", data.title);\n          vm.$store.commit(\"setEditingTableId\", data.id);\n          data.settingsItemProps && vm.$store.commit(\"updateSettings\", data.settingsItemProps);\n          data.fontSettings && vm.$store.commit(\"updatefontSettings\", data.fontSettings);\n          vm.$router.push({\n            name: \"Edit Existing\",\n            query: { table_id: data.id },\n          });\n        },\n      });\n    },\n    mountFonts() {\n      var myobj = document.getElementById(\"gfonts\");\n      if(myobj) {\n        myobj.remove();\n      }\n\n      var head  = document.getElementsByTagName('head')[0];\n      var link  = document.createElement('link');\n      link.id   = 'gfonts';\n      link.rel  = 'stylesheet';\n      link.type = 'text/css';\n      link.href = 'https://fonts.googleapis.com/css2?family=Montserrat&display=swap';\n      link.media = 'all';\n      head.appendChild(link);\n    }\n  },\n  computed: {\n    toEditTable: (vm) => {\n      return vm.$route.query.table_id ? vm.$route.query.table_id : null;\n    },\n    avaiableTables: (vm) => {\n      return vm.$store.state.tableList;\n    },\n    showSettings: (vm) => {\n      return vm.$store.state.showSettings;\n    },\n    tableTitle: {\n      get: function () {\n        return this.$store.state.tableTitle;\n      },\n      set: function (newString) {\n        return (this.$store.state.tableTitle = newString);\n      },\n    },\n  },\n  components: {\n    tableEditor,\n    settingsModal\n  },\n  mounted() {\n    if (this.toEditTable) {\n      jQuery.ajax({\n        type: \"GET\",\n        vm: this,\n        url: ajaxurl + `?action=sprdsh_get_table_cells&id=${this.toEditTable}`,\n        success(data) {\n          let { vm } = this;\n          vm.$store.commit(\"updateGrid\", data.grid.data);\n          vm.$store.commit(\"setTitle\", data.title);\n          vm.$store.commit(\"setEditingTableId\", data.id);\n          data.settingsItemProps && vm.$store.commit(\"updateSettings\", data.settingsItemProps);\n          data.fontSettings && vm.$store.commit(\"updatefontSettings\", data.fontSettings);\n          data.tableBodyFontSettings && vm.$store.commit(\"updateTableBodyfontSettings\", data.tableBodyFontSettings);\n          data.updateFontUrls && vm.$store.commit('updateFontUrls', data.fontUrls);\n        },\n      });\n      this.$store.commit(\"setPageTitle\", \"Editing Table\");\n      this.mountFonts();\n    }\n    if (!this.toEditTable) {\n      let updateListTables = (data) => {\n        if (data.length == 0) {\n          this.isEmptyTableList = true\n        }\n        this.$store.commit(\"availableTables\", data);\n      };\n      jQuery.ajax({\n        type: \"GET\",\n        url: ajaxurl + \"?action=sprdsh_list_tables\",\n        success: updateListTables,\n      });\n    }\n  },\n};\n</script>"],"names":[],"version":3,"file":"index.9f2c0e6c.css.map","sourceRoot":"/__parcel_source_root/"}